{"title":"KOR_EC2 Right Sizing Overview","description":"https://docs.aws.amazon.com/whitepapers/latest/cost-optimization-right-sizing/tips-for-right-sizing-your-workloads.html\n\nAnalyze performance data to right size your EC2 instances. Identify idle instances and ones that are underutilized. Key metrics to look for are CPU usage and memory usage. Identify instances with a maximum CPU usage and memory usage of less than 40% over a four-week period. These are the instances that you will want to right size to reduce costs.\n\ndatadog_demo_keep:true","widgets":[{"id":6,"definition":{"type":"image","url":"https://datadog-docs.imgix.net/images/integrations_logos/amazon_ec2.png","sizing":"fit"},"layout":{"x":0,"y":0,"width":3,"height":2}},{"id":7,"definition":{"title":"EC2 Instances","title_size":"16","title_align":"left","time":{},"type":"query_value","requests":[{"response_format":"scalar","queries":[{"query":"sum:system.cpu.idle{$team,$instance-type,$aws_account} by {host}","data_source":"metrics","name":"query1","aggregator":"last"}],"formulas":[{"formula":"count_not_null(query1)"}]}],"custom_links":[],"precision":0},"layout":{"x":3,"y":0,"width":4,"height":2}},{"id":4,"definition":{"title":"AWS Right Sizing Guideline: Maximum CPU usage < 40% (Lowest 50)","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"100 - top(query1, 50, 'last', 'desc')"}],"response_format":"timeseries","queries":[{"query":"max:system.cpu.idle{$team,$instance-type,$aws_account} by {host}.rollup(60)","data_source":"metrics","name":"query1"}],"style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false,"scale":"log"},"markers":[{"label":" 60 - 100 - ok ","value":"60 < y < 100","display_type":"ok solid"},{"label":" < 60 - potential underutilzation ","value":"40 < y < 60","display_type":"warning solid"},{"label":" < 40 - needs right-sizing ","value":"0 < y < 40","display_type":"error solid"}]},"layout":{"x":7,"y":0,"width":4,"height":2}},{"id":3,"definition":{"title":"Underutilized Instances by both CPU and Memory (Top 50)","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"idle cpu (낮을 수록 잘 활용)","conditional_formats":[{"value":60,"custom_bg_color":"#cc2a2a","palette":"white_on_red","custom_fg_color":"#d56f6f","comparator":">"},{"palette":"white_on_yellow","value":40,"comparator":">"},{"palette":"white_on_green","value":40,"comparator":"<="}],"limit":{"count":500,"order":"desc"},"cell_display_mode":"number","formula":"default_zero(query1)"},{"alias":"min usable memory","conditional_formats":[{"palette":"white_on_red","value":0.6,"comparator":">"},{"palette":"white_on_yellow","value":0.4,"comparator":">"},{"palette":"white_on_green","value":0.4,"comparator":"<="}],"formula":"query2"}],"response_format":"scalar","queries":[{"query":"min:system.cpu.idle{$instance-type,$team,$aws_account} by {name,instance-type}","data_source":"metrics","name":"query1","aggregator":"max"},{"query":"min:system.mem.pct_usable{$instance-type,$team,$aws_account} by {name,instance-type}","data_source":"metrics","name":"query2","aggregator":"min"}]}]},"layout":{"x":0,"y":2,"width":7,"height":8}},{"id":2,"definition":{"title":"AWS Right Sizing Guideline: Maximum memory usage < 40% (lowest 50) (requires Datadog Agent)","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"1 - top(ewma_20(query1), 100, 'last', 'desc')"}],"response_format":"timeseries","queries":[{"query":"min:system.mem.pct_usable{$instance-type,$team,$aws_account} by {host}","data_source":"metrics","name":"query1"}],"style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[{"label":" 60 - 100 - ok ","value":"y > 0.6","display_type":"ok solid"},{"label":" < 60 - potential underutilzation ","value":"0.4 < y < 0.6","display_type":"warning solid"},{"label":" < 40 - needs right-sizing ","value":"0 < y < 0.4","display_type":"error solid"}]},"layout":{"x":7,"y":2,"width":4,"height":2}},{"id":0,"definition":{"title":"Guideline: Maximum CPU usage < 40%","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"formula":"100 - query1","conditional_formats":[{"palette":"white_on_red","value":40,"comparator":"<"},{"palette":"white_on_yellow","value":60,"comparator":"<"},{"palette":"white_on_green","value":60,"comparator":">="}],"limit":{"count":500,"order":"asc"}}],"response_format":"scalar","queries":[{"query":"min:system.cpu.idle{$instance-type,$team,$aws_account} by {host}","data_source":"metrics","name":"query1","aggregator":"min"}]}]},"layout":{"x":7,"y":4,"width":4,"height":3}},{"id":5,"definition":{"title":"Guideline: Maximum memory usage < 0.4","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"min usable memory","conditional_formats":[{"palette":"white_on_red","comparator":">","value":0.6},{"palette":"white_on_yellow","comparator":">","value":0.4}],"limit":{"count":25,"order":"desc"},"formula":"query1"}],"response_format":"scalar","queries":[{"query":"min:system.mem.pct_usable{$instance-type,$team,$aws_account} by {host,name}","data_source":"metrics","name":"query1","aggregator":"min"}]}]},"layout":{"x":7,"y":7,"width":4,"height":3}}],"template_variables":[{"name":"instance-type","prefix":"instance-type","available_values":[],"default":"*"},{"name":"team","prefix":"team","available_values":[],"default":"*"},{"name":"aws_account","prefix":"aws_account","available_values":[],"default":"*"}],"layout_type":"ordered","is_read_only":false,"notify_list":[],"reflow_type":"fixed","id":"ca6-j2r-uhp"}